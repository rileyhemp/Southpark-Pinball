{"version":3,"sources":["flipper.js"],"names":["Flipper","scene","x","y","blockOffsetX","blockOffsetY","blockRotation","stopperOffsetX","stopperOffsetY","flipperOffsetX","flipperOffsetY","isFlipping","torque","staticTorque","flipperLength","block","matter","add","image","isStatic","scaleX","scaleY","visible","rotation","stopper","pivot","setScale","setCircle","setStatic","rectA","Phaser","Physics","Matter","Bodies","rectangle","flipperBody","body","create","parts","flipper","setExistingBody","pin","constraint","stiffness","length","positionPin","forEach","el","setCollisionCategory","collisionGroupB","setCollidesWith","collisionGroupA","setPhysicsProperties","LeftFlipper","pointA","pointB","RightFlipper"],"mappings":"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","sourcesContent":["\r\n//set a circle in the beginning of the flipper and constrain it to the pivot directly. no offset. \r\n\r\nclass Flipper {\r\n    constructor(scene, x, y){\r\n        this.scene = scene\r\n        this.x = x\r\n        this.y = y\r\n        this.blockOffsetX = 25\r\n        this.blockOffsetY = 37\r\n        this.blockRotation = .50\r\n        this.stopperOffsetX = 25\r\n        this.stopperOffsetY = -25\r\n        this.flipperOffsetX = 25\r\n        this.flipperOffsetY = 5\r\n        this.isFlipping = false\r\n        this.torque = -1.5\r\n        this.staticTorque = 0.5\r\n        this.flipperLength = 62\r\n    }\r\n    createComponents(){\r\n        //Create bottom block\r\n        this.block = this.scene.matter.add.image(this.x + this.blockOffsetX,this.y + this.blockOffsetY, 'rectA', this.scene, {\r\n            isStatic: true\r\n        })\r\n        this.block.scaleX = .1\r\n        this.block.scaleY = .3\r\n        this.block.visible = false\r\n        this.block.rotation = this.blockRotation\r\n\r\n        //Create top stopper\r\n        this.stopper = this.scene.matter.add.image(this.x + this.stopperOffsetX,this.y + this.stopperOffsetY ,'rectA', this.scene, {\r\n            isStatic: true\r\n        })\r\n        this.stopper.scaleX = .1\r\n        this.stopper.scaleY = .4\r\n        this.stopper.visible = false\r\n\r\n        //Create pivot point\r\n        this.pivot = this.scene.matter.add.image(this.x, this.y, null, this.scene)\r\n        this.pivot.setScale(.2)\r\n        this.pivot.setCircle(1)\r\n        this.pivot.setStatic(true)\r\n\r\n        //Create flipper\r\n        let rectA = Phaser.Physics.Matter.Matter.Bodies.rectangle(this.x + this.flipperOffsetX , this.y + this.flipperOffsetY, this.flipperLength, 16)\r\n        this.flipperBody = this.scene.matter.body.create({\r\n            parts: [ rectA ]\r\n        })\r\n        this.flipper = this.scene.matter.add.image(150, 0, null).setScale(0.2).setExistingBody(this.flipperBody)\r\n        //Create pin\r\n        this.pin = this.scene.matter.add.constraint(this.pivot, this.flipper)\r\n        this.pin.stiffness = 0.9\r\n        this.pin.length = 0\r\n        this.positionPin()\r\n    }\r\n\r\n    setPhysicsProperties(){\r\n        \r\n    }\r\n\r\n    setCollisionGroups(){\r\n        [ this.block, this.stopper, this.flipper ].forEach( el => {\r\n            el.setCollisionCategory(collisionGroupB)\r\n        })\r\n        this.stopper.setCollidesWith(collisionGroupB)\r\n        this.flipper.setCollidesWith([ collisionGroupA, collisionGroupB ])\r\n\r\n        this.setPhysicsProperties()\r\n    }\r\n\r\n    flip(){\r\n        this.flipper.body.torque = this.torque\r\n        if(this.isFlipping){\r\n            this.flipper.body.torque = this.torque\r\n        }\r\n    }\r\n\r\n    hold(){\r\n        this.flipper.body.torque = this.staticTorque\r\n        if (this.isFlipping){\r\n            this.flipper.body.torque = -this.staticTorque\r\n        }\r\n    }\r\n\r\n}\r\n\r\nclass LeftFlipper extends Flipper {\r\n    constructor(scene, x, y){\r\n        super(scene, x, y)\r\n        super.createComponents()\r\n        super.setCollisionGroups()\r\n    }\r\n    positionPin(){\r\n        this.pin.pointA = {\r\n            x: 5,  \r\n            y: 5\r\n        }\r\n        this.pin.pointB = {\r\n            x: -this.flipperLength/2+3, \r\n            y: 0\r\n        }\r\n    }\r\n}\r\n\r\nclass RightFlipper extends Flipper {\r\n    constructor(scene, x, y){\r\n        super(scene, x, y)\r\n        this.blockOffsetX = -this.blockOffsetX\r\n        this.blockRotation = -this.blockRotation\r\n        this.stopperOffsetX = -this.stopperOffsetX\r\n        this.flipperOffsetX = -this.flipperOffsetX\r\n        this.torque = -this.torque\r\n        this.staticTorque = -this.staticTorque\r\n        super.createComponents()\r\n        super.setCollisionGroups()\r\n    }\r\n    positionPin(){\r\n        this.pin.pointA = {\r\n            x: -5,  \r\n            y: 5\r\n        }\r\n        this.pin.pointB = {\r\n            x: this.flipperLength/2-3, \r\n            y: 0\r\n        }\r\n    }\r\n}"],"file":"flipper.js"}